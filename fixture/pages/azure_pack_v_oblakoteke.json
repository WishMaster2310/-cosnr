{
	"id": "azure_pack_v_oblakoteke",
	"source": "habrahabr.ru",
	"source_url": "http://habrahabr.ru/company/oblakoteka/blog/259629/",
	"name": "Azure Pack в Облакотеке",
	"links": ["cloudv", "oblakoteka_virtualnaja_infrastruktura"],
	"general": [
		{
			"caption": "Почему Azure Pack",
			"content": "<p>Традиционно основой IaaS-платформы &#171;Облакотеки&#187; является стек продуктов Microsoft: виртуализация Hyper-V и&#160;весь необходимый &#171;обвес&#187; на&#160;Microsoft System Center. В&#160;качестве провиженинговой системы использованы собственные разработки специалистов &#171;Облакотеки&#187;, которые следили за&#160;развитием Azure Pack с&#160;момента его появления. Второй причиной внедрения именно Azure Pack является&#160;то, что многие специалисты и&#160;разработчики имеют опыт работы с&#160;интерфейсом портала управления Microsoft Azure, что существенно упрощает для них использование сервисов &#171;Облакотеки&#187;.</p> <p>Появление программы Cloud OS&#160;Network Russia и&#160;перенос даты вступления в&#160;силу 242-ФЗ на&#160;1&#160;сентября 2015, что активизировало миграцию в&#160;РФ с&#160;зарубежных хостингов, ускорило принятие решения о&#160;необходимости внедрения Azure Pack.</p>"
		},
		{
			"caption": "Функциональность Azure Pack",
			"content": "<p>Функционально Azure Pack решает основные задачи &#171;Облакотеки&#187;&#160;&#8212; развертывание и&#160;сопровождение (элементов) IT-инфраструктур предприятий, то&#160;есть это современная IaaS-платформа с&#160;максимальным самообслуживанием. Azure Pack дает действительно хороший баланс между простотой развертывания IT-инфраструктур, удобными доступным из&#160;любого браузера веб-интерфейсом управления Azure, возможностью создания виртуальных сетей и&#160;построением Site-to-Site VPN-соединений, а&#160;также возможностью делегирования технических функций управления путем добавления соадминистраторов к&#160;управлению виртуальными ресурсами. Специальный функционал дает возможность управлять всеми ресурсами облака из&#160;единого интерфейса управления.</p> <p>Кроме того, для данной платформы характерна надежность и&#160;быстродействие, а&#160;также Azure Pack позволяет провести мероприятия на&#160;соответствие требованиям закона по&#160;защите персональных данных.</p> <p>Еще на&#160;стадии планирования создания сервиса у&#160;&#171;Облакотеки&#187; возникло очень много вопросов&#160;&#8212; как интегрировать, как правильнее использовать, что учесть и&#160;как решать возможные сложности интеграции продукта со&#160;своей инфраструктурой. Разработчики &#171;Облакотеки&#187; обратились за&#160;помощью в&#160;Microsoft&#160;&#8212; и&#160;на&#160;всех этапах внедрения значительную помощь им&#160;оказали именно специалисты Microsoft Consulting. Совместно с&#160;ними были проработаны как основные архитектурные моменты, так и&#160;важные технические детали.</p>"
		},
		{
			"caption": "Развертывание и интеграция",
			"content": "<p>Все развертывание сначала выполнялось в&#160;&#171;песочнице&#187;, где были изучины все возможности, плюсы и&#160;минусы Azure Pack и&#160;была выполнена интеграция. Особых сложностей с&#160;развертыванием решения не&#160;возникло. Весь набор нужных служб развертывается достаточно быстро и&#160;без проблем. Основной задачей было решить вопрос с&#160;учетом ресурсов и&#160;биллингом.</p> <p>Для биллинга и&#160;учета ресурсов и&#160;финансов у&#160;сервисов &#171;Облакотеки&#187; существует панель управления собственной разработки, поэтому необходимо было связать два разных инструмента управления.</p> <p>Здесь разработчикам пришлось учесть некоторые особенности.</p> <p>Во-первых, сам Azure Pack не&#160;создает никаких облаков (подписок) и&#160;не&#160;может удалять ни&#160;сами облака, ни&#160;ресурсы внутри них. Все привязывается к&#160;уже созданным ресурсам в&#160;VMM. Поэтому в&#160;получившемся сервисе облака создаются именно из&#160;панели &#171;Облакотеки&#187; и&#160;затем &#171;подвязываются&#187; к&#160;интерфейсу Azure Pack.</p> <p>Во-вторых, полная и&#160;достаточная документация по&#160;решению отсутствует, особенно в&#160;части автоматизации. В&#160;итоге для интеграции с&#160;биллингом и&#160;панелью управления было решено использовать не&#160;API, а&#160;powershell-скрипты, которые позволяют выполнить создание ресурсов и&#160;управление ими.</p> <p>В-третьих, в&#160;Azure Pack отсутствует штатный функционал для работы с&#160;библиотекой.</p> <p>Поэтому в&#160;сервисе реализована возможность использования собственной библиотеки следующим образом: в&#160;рамках тарифных планов создается FTP-доступ к&#160;собственной изолированной библиотеке, которая используется потом учетной записью пользователя Azure Pack. Таким образом пользователям предоставляется возможность загрузить свои образы или шаблоны и&#160;затем использовать&#160;их.</p> <p>Для интеграции с&#160;интерфейсом управления Azure Pack &#171;Облакотекой&#187; был разработан собственный web-сервис, связывающий три элемента&#160;&#8212; панель &#171;Облакотеки&#187;, Azure Pack и&#160;VMM.</p> <p>Так, на&#160;выходе сервисной панели управления получается облако (подписка), а&#160;дальнейшее управление ресурсами внутри подписки передается интерфейсу Azure Pack.</p> <p>В&#160;итоге работы специалисты &#171;Облакотеки&#187; пришли к&#160;концепции &#171;одно облако = один план = одна подписка&#187;. Это позволяет им&#160;вести учет и&#160;ограничивать набор ресурсов, предоставляемых в&#160;использование конечным клиентам.</p>"
		},
		{
			"caption": "Важные технические особенности сервиса",
			"content": "<p>Azure Pack не&#160;умеет создавать виртуальные сети на&#160;основе VLAN и&#160;работает только с&#160;виртуальными сетями HVGRE, поэтому для развертывания была настроена виртуализация сетей (с&#160;логическими сетями и&#160;шлюзами), а&#160;также перенастроены VMM&#160;на работу с&#160;сетями;</p> <p>Быстрое развертывание Azure Pack может быть выполнено на&#160;одном сервере, но&#160;роли были разнесены по&#160;разным серверам с&#160;целью дальнейших возможностей масштабирования.</p> <p>В&#160;ходе полноценной эксплуатации выяснилось, что присутствует ограничение на&#160;количество выводимых объектов в&#160;интерфейсе Azure Pack. SPF ограничивает количество выводимых объектов до&#160;500, а&#160;поскольку Azure Pack работает с&#160;облаками через SPF, часть объектов просто не&#160;отображалась.</p> <p>Это было обнаружено в&#160;ходе работы над административным интерфейсом управления, в&#160;документации информации не&#160;было. Но&#160;в&#160;итоге проблема была исправлена изменением параметра в&#160;двух конфигурационных файлах Web.config в&#160;строчке &#60;EntitySet name=&#34;*&#34; maxResults=&#34;500&#8243; /&#62;.</p>"
		},
		{
			"caption": "Функционал для партнеров",
			"content": "<p>&#171;Облакотека&#187;&#160;&#8212; это прежде всего платформа для партнеров: интеграторов и&#160;аутсорсеров, которые обслуживают десятки IT-инфраструктур конечных клиентов. Для создателей сервиса было важно добавить элементы массового обслуживания, чтобы партнер в&#160;идеале мог обслужить &#171;всех клиентов одним кликом&#187;. Azure Pack идеально для этого подходит. Назначая одного и&#160;того&#160;же администратора или соадминистратора на&#160;клиентское облако (подписку), портал управления Azure Pack позволяет партнеру-администратору видеть все сервисы всех клиентов в&#160;едином списке&#160;и, соответственно, проводить манипуляции без постоянной переавторизации.</p>"
		},
		{
			"caption": "С&#160;чем еще пришлось столкнуться специалистам &#171;Облакотеки&#187;",
			"content": "<p> В&#160;Azure Pack есть небольшой набор ограничений, с&#160;которыми столкнулись разработчики и&#160;для которых нашли пути обхода:</p> <ul> <li>Фиксированные конфигурации виртуальных машин&#160;&#8212; поскольку развертывание виртуальных машин осуществляется только из&#160;шаблонов, гибкость определяется только тем набором конфигураций, которые определены как профили оборудования для виртуальных машин. Функционал &#171;собери свою виртуалку&#187; не&#160;предусмотрен. В&#160;связи с&#160;этим количество шаблонов, выдаваемых в&#160;список, равно декартову произведению наборов параметров: vCPU, RAM, тип хранилища, ОС, то&#160;есть если делать относительно гибко, то&#160;несколько сотен. Разработчикам сервиса пришлось подготовить и&#160;поддерживать большой набор типовых конфигураций, чтобы удовлетворить наиболее часто встречающиеся потребности клиентов. И&#160;этот набор постоянно пополняется благодаря новым запросам конечных клиентов.</li> <li>В&#160;Azure Pack не&#160;работают снепшоты (чекпойнты), но&#160;в&#160;ближайшее время планируется внедрение этой очень важной и&#160;нужной функции (поскольку такая возможность уже появилась в&#160;UR6);</li> <li>Нет возможности подключать и&#160;управлять ресурсами в&#160;облаках в&#160;разных локациях&#160;&#8212; функционал подключения в&#160;едином интерфейсе к&#160;частным облакам и&#160;облакам, размещенным у&#160;других провайдеров, отсутствует. Соответственно нет возможности быстро переносить виртуальные машины, например, с&#160;основной площадки, на&#160;резервную, но&#160;скоро такой функционал появится.</li> </ul> <p>Подводя итоги работы над созданием сервиса, специалисты &#171;Облакотеки&#187; говорят: &#171;Azure Pack как инструмент для управления облаками&#160;&#8212; очень хорошая и&#160;приятная штука, позволяющая выполнять большой набор типовых операций и&#160;сэкономить значительное время на&#160;развертывание и&#160;настройку инфраструктур. Очень не&#160;тяжелое, при этом достаточно функциональное, причем уже привычное многим специалистам, решение. Простота установки и&#160;интеграции дает возможность быстро и&#160;без дополнительных затрат получить готовый интерфейс управления&#187;.</p> <p>С&#160;учетом постоянной доработки нужного функционала и&#160;планами на&#160;развитие новая IaaS-платформа &#171;Облакотеки&#187; с&#160;Azure Pack является очень перспективным продуктом и&#160;заслуживает внимания провайдеров, предоставляющих услуги размещения IaaS-инфраструктур или для администраторов частных облаков.</p>"
		}
	]
}