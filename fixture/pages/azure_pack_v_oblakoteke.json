{
	"id": "azure_pack_v_oblakoteke",
	"source": "habrahabr.ru",
	"source_url": "http://habrahabr.ru/company/oblakoteka/blog/259629/",
	"name": "Azure Pack в Облакотеке",
	"links": ["cloudv", "oblakoteka_virtualnaja_infrastruktura"],
	"general": [
		{
			"caption": "Почему Azure Pack",
			"content": "<p>Традиционно основой IaaS-платформы &laquo;Облакотеки&raquo; является стек продуктов Microsoft: виртуализация Hyper-V и&nbsp;весь необходимый &laquo;обвес&raquo; на&nbsp;Microsoft System Center. В&nbsp;качестве провиженинговой системы использованы собственные разработки специалистов &laquo;Облакотеки&raquo;, которые следили за&nbsp;развитием Azure Pack с&nbsp;момента его появления. Второй причиной внедрения именно Azure Pack является&nbsp;то, что многие специалисты и&nbsp;разработчики имеют опыт работы с&nbsp;интерфейсом портала управления Microsoft Azure, что существенно упрощает для них использование сервисов &laquo;Облакотеки&raquo;.</p> <p>Появление программы Cloud OS&nbsp;Network Russia и&nbsp;перенос даты вступления в&nbsp;силу 242-ФЗ на&nbsp;1&nbsp;сентября 2015, что активизировало миграцию в&nbsp;РФ с&nbsp;зарубежных хостингов, ускорило принятие решения о&nbsp;необходимости внедрения Azure Pack.</p>"
		},
		{
			"caption": "Функциональность Azure Pack",
			"content": "<p>Функционально Azure Pack решает основные задачи &laquo;Облакотеки&raquo;&nbsp;&mdash; развертывание и&nbsp;сопровождение (элементов) IT-инфраструктур предприятий, то&nbsp;есть это современная IaaS-платформа с&nbsp;максимальным самообслуживанием. Azure Pack дает действительно хороший баланс между простотой развертывания IT-инфраструктур, удобными доступным из&nbsp;любого браузера веб-интерфейсом управления Azure, возможностью создания виртуальных сетей и&nbsp;построением Site-to-Site VPN-соединений, а&nbsp;также возможностью делегирования технических функций управления путем добавления соадминистраторов к&nbsp;управлению виртуальными ресурсами. Специальный функционал дает возможность управлять всеми ресурсами облака из&nbsp;единого интерфейса управления.</p> <p>Кроме того, для данной платформы характерна надежность и&nbsp;быстродействие, а&nbsp;также Azure Pack позволяет провести мероприятия на&nbsp;соответствие требованиям закона по&nbsp;защите персональных данных.</p> <p>Еще на&nbsp;стадии планирования создания сервиса у&nbsp;&laquo;Облакотеки&raquo; возникло очень много вопросов&nbsp;&mdash; как интегрировать, как правильнее использовать, что учесть и&nbsp;как решать возможные сложности интеграции продукта со&nbsp;своей инфраструктурой. Разработчики &laquo;Облакотеки&raquo; обратились за&nbsp;помощью в&nbsp;Microsoft&nbsp;&mdash; и&nbsp;на&nbsp;всех этапах внедрения значительную помощь им&nbsp;оказали именно специалисты Microsoft Consulting. Совместно с&nbsp;ними были проработаны как основные архитектурные моменты, так и&nbsp;важные технические детали.</p>"
		},
		{
			"caption": "Развертывание и интеграция",
			"content": "<p>Все развертывание сначала выполнялось в&nbsp;&laquo;песочнице&raquo;, где были изучины все возможности, плюсы и&nbsp;минусы Azure Pack и&nbsp;была выполнена интеграция. Особых сложностей с&nbsp;развертыванием решения не&nbsp;возникло. Весь набор нужных служб развертывается достаточно быстро и&nbsp;без проблем. Основной задачей было решить вопрос с&nbsp;учетом ресурсов и&nbsp;биллингом.</p> <p>Для биллинга и&nbsp;учета ресурсов и&nbsp;финансов у&nbsp;сервисов &laquo;Облакотеки&raquo; существует панель управления собственной разработки, поэтому необходимо было связать два разных инструмента управления.</p> <p>Здесь разработчикам пришлось учесть некоторые особенности.</p> <p>Во-первых, сам Azure Pack не&nbsp;создает никаких облаков (подписок) и&nbsp;не&nbsp;может удалять ни&nbsp;сами облака, ни&nbsp;ресурсы внутри них. Все привязывается к&nbsp;уже созданным ресурсам в&nbsp;VMM. Поэтому в&nbsp;получившемся сервисе облака создаются именно из&nbsp;панели &laquo;Облакотеки&raquo; и&nbsp;затем &laquo;подвязываются&raquo; к&nbsp;интерфейсу Azure Pack.</p> <p>Во-вторых, полная и&nbsp;достаточная документация по&nbsp;решению отсутствует, особенно в&nbsp;части автоматизации. В&nbsp;итоге для интеграции с&nbsp;биллингом и&nbsp;панелью управления было решено использовать не&nbsp;API, а&nbsp;powershell-скрипты, которые позволяют выполнить создание ресурсов и&nbsp;управление ими.</p> <p>В-третьих, в&nbsp;Azure Pack отсутствует штатный функционал для работы с&nbsp;библиотекой.</p> <p>Поэтому в&nbsp;сервисе реализована возможность использования собственной библиотеки следующим образом: в&nbsp;рамках тарифных планов создается FTP-доступ к&nbsp;собственной изолированной библиотеке, которая используется потом учетной записью пользователя Azure Pack. Таким образом пользователям предоставляется возможность загрузить свои образы или шаблоны и&nbsp;затем использовать&nbsp;их.</p> <p>Для интеграции с&nbsp;интерфейсом управления Azure Pack &laquo;Облакотекой&raquo; был разработан собственный web-сервис, связывающий три элемента&nbsp;&mdash; панель &laquo;Облакотеки&raquo;, Azure Pack и&nbsp;VMM.</p> <p>Так, на&nbsp;выходе сервисной панели управления получается облако (подписка), а&nbsp;дальнейшее управление ресурсами внутри подписки передается интерфейсу Azure Pack.</p> <p>В&nbsp;итоге работы специалисты &laquo;Облакотеки&raquo; пришли к&nbsp;концепции &laquo;одно облако = один план = одна подписка&raquo;. Это позволяет им&nbsp;вести учет и&nbsp;ограничивать набор ресурсов, предоставляемых в&nbsp;использование конечным клиентам.</p>"
		},
		{
			"caption": "Важные технические особенности сервиса",
			"content": "<p>Azure Pack не&nbsp;умеет создавать виртуальные сети на&nbsp;основе VLAN и&nbsp;работает только с&nbsp;виртуальными сетями HVGRE, поэтому для развертывания была настроена виртуализация сетей (с&nbsp;логическими сетями и&nbsp;шлюзами), а&nbsp;также перенастроены VMM&nbsp;на работу с&nbsp;сетями;</p> <p>Быстрое развертывание Azure Pack может быть выполнено на&nbsp;одном сервере, но&nbsp;роли были разнесены по&nbsp;разным серверам с&nbsp;целью дальнейших возможностей масштабирования.</p> <p>В&nbsp;ходе полноценной эксплуатации выяснилось, что присутствует ограничение на&nbsp;количество выводимых объектов в&nbsp;интерфейсе Azure Pack. SPF ограничивает количество выводимых объектов до&nbsp;500, а&nbsp;поскольку Azure Pack работает с&nbsp;облаками через SPF, часть объектов просто не&nbsp;отображалась.</p> <p>Это было обнаружено в&nbsp;ходе работы над административным интерфейсом управления, в&nbsp;документации информации не&nbsp;было. Но&nbsp;в&nbsp;итоге проблема была исправлена изменением параметра в&nbsp;двух конфигурационных файлах Web.config в&nbsp;строчке &lt;EntitySet name=&quot;*&quot; maxResults=&quot;500&Prime; /&gt;.</p>"
		},
		{
			"caption": "Функционал для партнеров",
			"content": "<p>&laquo;Облакотека&raquo;&nbsp;&mdash; это прежде всего платформа для партнеров: интеграторов и&nbsp;аутсорсеров, которые обслуживают десятки IT-инфраструктур конечных клиентов. Для создателей сервиса было важно добавить элементы массового обслуживания, чтобы партнер в&nbsp;идеале мог обслужить &laquo;всех клиентов одним кликом&raquo;. Azure Pack идеально для этого подходит. Назначая одного и&nbsp;того&nbsp;же администратора или соадминистратора на&nbsp;клиентское облако (подписку), портал управления Azure Pack позволяет партнеру-администратору видеть все сервисы всех клиентов в&nbsp;едином списке&nbsp;и, соответственно, проводить манипуляции без постоянной переавторизации.</p>"
		},
		{
			"caption": "С&nbsp;чем еще пришлось столкнуться специалистам &laquo;Облакотеки&raquo;",
			"content": "<p> В&nbsp;Azure Pack есть небольшой набор ограничений, с&nbsp;которыми столкнулись разработчики и&nbsp;для которых нашли пути обхода:</p> <ul> <li>Фиксированные конфигурации виртуальных машин&nbsp;&mdash; поскольку развертывание виртуальных машин осуществляется только из&nbsp;шаблонов, гибкость определяется только тем набором конфигураций, которые определены как профили оборудования для виртуальных машин. Функционал &laquo;собери свою виртуалку&raquo; не&nbsp;предусмотрен. В&nbsp;связи с&nbsp;этим количество шаблонов, выдаваемых в&nbsp;список, равно декартову произведению наборов параметров: vCPU, RAM, тип хранилища, ОС, то&nbsp;есть если делать относительно гибко, то&nbsp;несколько сотен. Разработчикам сервиса пришлось подготовить и&nbsp;поддерживать большой набор типовых конфигураций, чтобы удовлетворить наиболее часто встречающиеся потребности клиентов. И&nbsp;этот набор постоянно пополняется благодаря новым запросам конечных клиентов.</li> <li>В&nbsp;Azure Pack не&nbsp;работают снепшоты (чекпойнты), но&nbsp;в&nbsp;ближайшее время планируется внедрение этой очень важной и&nbsp;нужной функции (поскольку такая возможность уже появилась в&nbsp;UR6);</li> <li>Нет возможности подключать и&nbsp;управлять ресурсами в&nbsp;облаках в&nbsp;разных локациях&nbsp;&mdash; функционал подключения в&nbsp;едином интерфейсе к&nbsp;частным облакам и&nbsp;облакам, размещенным у&nbsp;других провайдеров, отсутствует. Соответственно нет возможности быстро переносить виртуальные машины, например, с&nbsp;основной площадки, на&nbsp;резервную, но&nbsp;скоро такой функционал появится.</li> </ul> <p>Подводя итоги работы над созданием сервиса, специалисты &laquo;Облакотеки&raquo; говорят: &laquo;Azure Pack как инструмент для управления облаками&nbsp;&mdash; очень хорошая и&nbsp;приятная штука, позволяющая выполнять большой набор типовых операций и&nbsp;сэкономить значительное время на&nbsp;развертывание и&nbsp;настройку инфраструктур. Очень не&nbsp;тяжелое, при этом достаточно функциональное, причем уже привычное многим специалистам, решение. Простота установки и&nbsp;интеграции дает возможность быстро и&nbsp;без дополнительных затрат получить готовый интерфейс управления&raquo;.</p> <p>С&nbsp;учетом постоянной доработки нужного функционала и&nbsp;планами на&nbsp;развитие новая IaaS-платформа &laquo;Облакотеки&raquo; с&nbsp;Azure Pack является очень перспективным продуктом и&nbsp;заслуживает внимания провайдеров, предоставляющих услуги размещения IaaS-инфраструктур или для администраторов частных облаков.</p>"
		}
	]
}